cmake_minimum_required(VERSION 3.8)
project(bass CXX)
add_library(bass INTERFACE)
target_include_directories(bass INTERFACE ${PROJECT_SOURCE_DIR}/include)
if(UNIX)
    execute_process(COMMAND uname -m COMMAND tr -d '\n' OUTPUT_VARIABLE ARCHITECTURE)
    message("Target Architecture: ${ARCHITECTURE}")
    if(NOT APPLE)
        message("Target OS: Linux")
        if(${ARCHITECTURE} STREQUAL "x86_64")
            target_link_libraries(bass INTERFACE ${PROJECT_SOURCE_DIR}/lib/linux/x64/libbass.so)
            message("=> x64 is selected")
        else()
            target_link_libraries(bass INTERFACE ${PROJECT_SOURCE_DIR}/lib/linux/libbass.so)
            message("=> x86 is selected")
        endif()
    else()
        message("Target OS: OSX")
        target_link_libraries(bass INTERFACE ${PROJECT_SOURCE_DIR}/lib/osx/libbass.dylib)
    endif()
elseif(WIN32)
    message("Target OS: Windows")

    if("${CMAKE_GENERATOR_PLATFORM}" STREQUAL "Win32")
        set(ARCHITECTURE ${CMAKE_GENERATOR_PLATFORM})
    else()
        set(ARCHITECTURE $ENV{PROCESSOR_ARCHITECTURE})
    endif()
    message("Target Architecture: ${ARCHITECTURE}")

    if(${ARCHITECTURE} STREQUAL "AMD64")
        target_link_libraries(bass INTERFACE ${PROJECT_SOURCE_DIR}/lib/win/x64/bass.lib)
        message("=> x64 is selected")
    else()
        target_link_libraries(bass INTERFACE ${PROJECT_SOURCE_DIR}/lib/win/bass.lib)
        message("=> x86 is selected")
    endif()
endif()
